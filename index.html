
<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>â—‹â–³â–¡S ë„í˜• í…ŒìŠ¤íŠ¸</title>
<style>
  :root{
    --bg:#fbf6f4;
    --title:#3c2f91;
    --frame:#b9764f;
    --accent:#3c2f91;
    --btn-border:#e6e6e6;
  }
  html,body{height:100%;margin:0}
  body{
    font-family:"Pretendard","Noto Sans KR",system-ui,-apple-system,Arial;
    background:var(--bg);color:#222;
    display:flex;flex-direction:column;align-items:center;
    padding:20px 16px 40px;
  }
  h1{color:var(--title);font-size:34px;margin:8px 0 6px;letter-spacing:2px}
  .subtitle{color:var(--title);text-align:center;font-size:14px;margin:0 0 18px}
  .board-wrap{position:relative;width:420px;max-width:92vw}
  #board{
    width:360px;height:360px;margin:0 auto;
    background:#fff;border:4px solid var(--frame);box-sizing:border-box;position:relative;
    touch-action:none; 
  }
  #inner{
    position:absolute;width:180px;height:180px;left:50%;top:50%;
    transform:translate(-50%,-50%);
    border:4px dashed rgba(183,132,112,0.35);pointer-events:none;
  }
  
  .tools{display:flex;gap:12px;justify-content:center;margin-top:18px;flex-wrap:wrap}
  
  .tool{width:64px;height:64px;border-radius:14px;border:2px solid var(--btn-border);
    display:flex;align-items:center;justify-content:center;background:#fff;
    font-size:28px;cursor:pointer;box-shadow:0 6px 20px rgba(60,47,145,0.06);
    transition:transform .12s,background .12s,border-color .12s}
  .tool.active{background:#efeefc;border-color:var(--accent);box-shadow:0 10px 26px rgba(60,47,145,0.14)}
  .actions{display:flex;gap:12px;justify-content:center;margin-top:12px;flex-wrap:wrap}
  .btn{padding:10px 16px;border-radius:10px;border:1px solid var(--btn-border);
    background:#fff;color:var(--accent);font-weight:600;cursor:pointer;}
  .btn.primary{background:var(--accent);color:#fff;border:none;box-shadow:0 6px 18px rgba(60,47,145,0.16)}
  .placed{position:absolute;user-select:none;display:flex;align-items:center;justify-content:center;
    box-sizing:border-box;border-radius:8px;transform-origin:center center;
    touch-action: none;
  }
  /* [ì¶”ê°€/ìˆ˜ì •] SVGê°€ ë¶€ëª¨ í¬ê¸°ì— ë§ê²Œ ì¡°ì ˆë˜ë„ë¡ ì„¤ì • */
  .placed svg { width: 100%; height: 100%; }

  .placed .badge{position:absolute;right:4px;bottom:4px;background:var(--accent);color:#fff;font-size:11px;padding:2px 6px;border-radius:8px;z-index: 1;}
  
  .handle{position:absolute;width:16px;height:16px;right:-8px;bottom:-8px;background:#fff;border:2px solid var(--accent);border-radius:6px;box-shadow:0 4px 10px rgba(0,0,0,0.08);touch-action:none;cursor:se-resize;}
  
  .rotate-handle{position:absolute;width:14px;height:14px;top:-24px;left:50%;transform:translateX(-50%);background:#fff;border:2px solid var(--accent);border-radius:50%;cursor:grab;touch-action:none;}
  
  #resultBox{width:420px;max-width:92vw;margin:18px auto 0;text-align:left}
  
  .card{background:#fff;padding:14px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.06)}
  .card h3{margin:0 0 8px;color:var(--accent)}
  .line{margin:8px 0;color:#222;line-height:1.6}
  .scent{margin-top:8px;color:#4b4b4b;font-weight:600}
  @media(max-width:420px){
    #board{width:320px;height:320px}
    #inner{width:160px;height:160px}
    .tool{width:56px;height:56px;font-size:24px}
    #resultBox{width:320px} 
    .card{width:auto;}
  }
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</style>
</head>
<body>

<h1>â—‹â–³â–¡S ë„í˜• í…ŒìŠ¤íŠ¸</h1>
<div class="subtitle">ê°€ì¥ ë§ˆìŒì— ë“œëŠ” ë„í˜•ì„ 3ë²ˆ, ë‚˜ë¨¸ì§€ë¥¼ ê°ê° 1ë²ˆì”© ë°°ì¹˜í•˜ì„¸ìš”.</div>

<div class="board-wrap">
  <div id="board"><div id="inner"></div></div>
</div>

<div class="tools">
  <div class="tool active" data-shape="circle">â—‹</div>
  <div class="tool" data-shape="triangle">â–³</div>
  <div class="tool" data-shape="square">â–¡</div>
  <div class="tool" data-shape="wave">S</div>
</div>

<div class="actions">
  <button id="undo" class="btn">Undo</button>
  <button id="reset" class="btn">ì´ˆê¸°í™”</button>
  <button id="analyze" class="btn primary">ê²°ê³¼ ë³´ê¸°</button>
</div>

<div id="resultBox">

  <div class="card">
    <h3>ê²€ì‚¬ ê²°ê³¼</h3>
    <div id="resultContent">
      <div class="line">ë„í˜•ì„ ë°°ì¹˜í•œ ë’¤ 'ê²°ê³¼ ë³´ê¸°'ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>
    </div>
  </div>

<div class="actions" style="margin-top:20px;">
  <button id="saveImage" class="btn">ğŸ“¸ ê²°ê³¼ ì´ë¯¸ì§€ ì €ì¥</button>
</div>

</div>

<script>
const board=document.getElementById('board');
const tools=document.querySelectorAll('.tool');
let currentTool='circle', placed=[], orderCounter=0;
const resultContent=document.getElementById('resultContent');

tools.forEach(t=>{
  t.addEventListener('click',()=>{
    tools.forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    currentTool=t.dataset.shape;
  });
});

board.addEventListener('pointerdown',ev=>{
  if(ev.target!==board)return;
  if(placed.length>=6){alert('ìµœëŒ€ 6ê°œê¹Œì§€ë§Œ ë°°ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');return;}
  const rect=board.getBoundingClientRect();
  addPlaced(currentTool,ev.clientX-rect.left,ev.clientY-rect.top,60);
});

function addPlaced(type,x,y,size){
  orderCounter++;
  const el=document.createElement('div');
  el.className='placed';
  el.style.left=(x-size/2)+'px';
  el.style.top=(y-size/2)+'px';
  el.style.width=size+'px';
  el.style.height=size+'px';
  el.dataset.id=Date.now()+Math.random();
  el.dataset.type=type;
  el.style.zIndex=100+orderCounter;
  el.dataset.rotate=0;

  const rec={el,type,left:x-size/2,top:y-size/2,size,rotate:0, sTextElement: null};

  // [í•µì‹¬ ìˆ˜ì •] SVGì— width="100%" height="100%" ì†ì„±ì„ ì¶”ê°€í•˜ì—¬ ë¶€ëª¨ div í¬ê¸°ì— ì¢…ì†ë˜ê²Œ í•¨
  if(type==='circle')
    el.innerHTML=`<svg viewBox="0 0 100 100" width="100%" height="100%"><circle cx="50" cy="50" r="42" stroke="#3c2f91" stroke-width="6" fill="none"/></svg><div class="badge">${orderCounter}</div>`;
  else if(type==='triangle')
    el.innerHTML=`<svg viewBox="0 0 100 100" width="100%" height="100%"><polygon points="50,8 8,92 92,92" stroke="#3c2f91" stroke-width="6" fill="none"/></svg><div class="badge">${orderCounter}</div>`;
  else if(type==='square')
    el.innerHTML=`<svg viewBox="0 0 100 100" width="100%" height="100%"><rect x="8" y="8" width="84" height="84" stroke="#3c2f91" stroke-width="6" fill="none"/></svg><div class="badge">${orderCounter}</div>`;
  else {
    const sText = document.createElement('div');
    sText.style.fontSize = `${size * 0.9}px`; 
    sText.style.color = '#3c2f91';
    sText.style.fontWeight = '700';
    sText.style.lineHeight = '1';
    sText.textContent = 'S';
    el.appendChild(sText);
    
    const badge = document.createElement('div');
    badge.className = 'badge';
    badge.textContent = orderCounter;
    el.appendChild(badge);

    rec.sTextElement = sText; 
  }

  const handle=document.createElement('div');handle.className='handle';
  const rot=document.createElement('div');rot.className='rotate-handle';
  
  el.appendChild(handle);
  el.appendChild(rot);
  board.appendChild(el);

  placed.push(rec);
  makeInteractive(el,handle,rot,rec); 
}

function makeInteractive(el,handle,rot,rec){
  // 1. ë„í˜• ì´ë™
  el.addEventListener('pointerdown',ev=>{
    if(ev.target===handle||ev.target===rot)return; 
        
    const startX=ev.clientX,startY=ev.clientY;
    const startLeft=parseFloat(el.style.left),startTop=parseFloat(el.style.top);
    function move(mv){
      const nx=Math.max(0,Math.min(board.clientWidth-rec.size,startLeft+(mv.clientX-startX)));
      const ny=Math.max(0,Math.min(board.clientHeight-rec.size,startTop+(mv.clientY-startY)));
      el.style.left=nx+'px';el.style.top=ny+'px';rec.left=nx;rec.top=ny;
    }
    function up(){window.removeEventListener('pointermove',move);window.removeEventListener('pointerup',up);}
    window.addEventListener('pointermove',move);window.addEventListener('pointerup',up);
  });

  // 2. í¬ê¸° ì¡°ì ˆ (í•¸ë“¤)
  handle.addEventListener('pointerdown',ev=>{
    ev.stopPropagation(); 
    const startX=ev.clientX,startY=ev.clientY;
    const startSize=rec.size;

    function move(mv){
      const dx=mv.clientX-startX;
      const dy=mv.clientY-startY;

      // X/Y ì¤‘ ë” í° ë³€í™”ëŸ‰ì— ë”°ë¼ í¬ê¸° ë³€ê²½ (ëŒ€ê°ì„  ë“œë˜ê·¸ íš¨ê³¼)
      const d = Math.abs(dx) > Math.abs(dy) ? dx : dy;
      
      const newSize=Math.max(20,Math.min(200,Math.round(startSize+d)));

      // ìœ„ì¹˜ ë³´ì •: í¬ê¸° ì¡°ì ˆì˜ ê¸°ì¤€ì ì„ ì™¼ìª½ ìœ„ë¡œ ê°€ì •í•˜ê³  ë³´ì • (ì•ˆí•˜ë©´ ì¤‘ì•™ ì •ë ¬ì´ ê¹¨ì§)
      const sizeDiff = newSize - rec.size;
      const newLeft = rec.left - sizeDiff / 2;
      const newTop = rec.top - sizeDiff / 2;

      // ë³´ë“œ ê²½ê³„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ ìµœì¢… ìœ„ì¹˜ ì œí•œ
      const finalLeft = Math.max(0, Math.min(board.clientWidth - newSize, newLeft));
      const finalTop = Math.max(0, Math.min(board.clientHeight - newSize, newTop));

      // í¬ê¸°ì™€ ìœ„ì¹˜ ì ìš©
      rec.size=newSize;
      rec.left=finalLeft;
      rec.top=finalTop;
      el.style.width=newSize+'px';
      el.style.height=newSize+'px';
      el.style.left=finalLeft+'px';
      el.style.top=finalTop+'px';
      
      // 'S' ë„í˜•ì¸ ê²½ìš°, í°íŠ¸ í¬ê¸° ì—…ë°ì´íŠ¸
      if (rec.type === 'wave' && rec.sTextElement) {
        rec.sTextElement.style.fontSize = `${newSize * 0.9}px`;
      }
    }
    function up(){window.removeEventListener('pointermove',move);window.removeEventListener('pointerup',up);}
    window.addEventListener('pointermove',move);
    window.addEventListener('pointerup',up);
  });

  // 3. íšŒì „
  rot.addEventListener('pointerdown',ev=>{
    ev.stopPropagation();
    const rect=el.getBoundingClientRect();
    const cx=rect.left+rect.width/2,cy=rect.top+rect.height/2;
    function move(mv){
      const angle=Math.atan2(mv.clientY-cy,mv.clientX-cx)*180/Math.PI;
      rec.rotate=angle;el.style.transform=`rotate(${angle}deg)`;
    }
    function up(){window.removeEventListener('pointermove',move);window.removeEventListener('pointerup',up);}
    window.addEventListener('pointermove',move);window.addEventListener('pointerup',up);
  });
} // makeInteractive í•¨ìˆ˜ ë

document.getElementById('undo').onclick=()=>{if(!placed.length)return;placed.pop().el.remove();}
document.getElementById('reset').onclick=()=>{
  if(!confirm('ëª¨ë“  ë„í˜•ì„ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?'))return;
  placed.forEach(p=>p.el.remove());placed=[];orderCounter=0;
  resultContent.innerHTML=`<div class="line">ë„í˜•ì„ ë°°ì¹˜í•œ ë’¤ 'ê²°ê³¼ ë³´ê¸°'ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>`;
};

/* ==== ë„í˜•ì‹¬ë¦¬í”„ë¡œíŒŒì¼ ê¸°ë°˜ ì •êµ í•´ì„ ==== */
document.getElementById('analyze').onclick = () => {
  if (placed.length < 4) {
    alert('ëª¨ë“  ë„í˜•ì„ ë°°ì¹˜í•œ ë’¤ ì‹¤í–‰í•˜ì„¸ìš”.');
    return;
  }

  // 1ï¸âƒ£ ê¸°ë³¸ ë°ì´í„° ì •ë¦¬
  const counts = {};
  placed.forEach(p => counts[p.type] = (counts[p.type] || 0) + 1);

  // 1ì°¨ ê¸°ì§ˆ (3íšŒ ë“±ì¥ ë„í˜• ë˜ëŠ” ìµœë‹¤)
  const dominant = Object.keys(counts).find(k => counts[k] === 3) ||
                   Object.keys(counts).reduce((a,b)=>(counts[a]||0)>=(counts[b]||0)?a:b);
  // 2ì°¨ ê¸°ì§ˆ (ë‘ ë²ˆì§¸ë¡œ ë§ì´ ë“±ì¥ or ì¤‘ì‹¬ ìœ„ì¹˜)
  let secondary = Object.keys(counts).filter(k => k !== dominant)
                    .reduce((a,b)=>(counts[a]||0)>=(counts[b]||0)?a:b);
  if (!secondary) secondary = Object.keys(counts).find(k => k !== dominant);

  // ì¤‘ì‹¬ì— ê°€ì¥ ê°€ê¹Œìš´ ë„í˜• ì°¾ê¸° (ë³´ë“œ ì¤‘ì•™ ê¸°ì¤€)
  const center = {x: board.clientWidth/2, y: board.clientHeight/2};
  const centerShape = placed.reduce((closest, p)=>{
    const cx = p.left + p.size/2, cy = p.top + p.size/2;
    const dist = Math.hypot(center.x - cx, center.y - cy);
    return dist < closest.dist ? {type:p.type, dist} : closest;
  }, {type:null, dist:Infinity}).type;
  if (centerShape && centerShape !== dominant) secondary = centerShape;

  // 2ï¸âƒ£ ì „ì²´ì  ëŠë‚Œ(ë°°ì¹˜ ê· í˜•) ë¶„ì„
  const avgX = placed.reduce((s,p)=>s+(p.left+p.size/2),0)/placed.length;
  const avgY = placed.reduce((s,p)=>s+(p.top+p.size/2),0)/placed.length;
  const deviationX = Math.abs(avgX - center.x);
  const deviationY = Math.abs(avgY - center.y);

  let balanceDesc = '';
  if (deviationX < 40 && deviationY < 40) balanceDesc = 'ë„í˜•ì´ ê· í˜•ê° ìˆê²Œ ë°°ì¹˜ë˜ì–´ ì‚¶ì˜ ì¡°í™”ì™€ ë‚´ì  ì•ˆì •ê°ì´ ëŠê»´ì§‘ë‹ˆë‹¤.';
  else if (deviationX > 100 || deviationY > 100) balanceDesc = 'ë„í˜•ì´ í•œìª½ìœ¼ë¡œ ì¹˜ìš°ì³ ìˆì–´ ì‚¬ê³ ë‚˜ ê°ì •ì´ í•œ ë°©í–¥ìœ¼ë¡œ ì ë¦¬ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.';
  else balanceDesc = 'ê· í˜•ì„ ìœ ì§€í•˜ë ¤ í•˜ì§€ë§Œ ë‚´ë©´ì ìœ¼ë¡œ ì•½ê°„ì˜ ê¸´ì¥ì´ë‚˜ ë¶ˆê· í˜•ì´ ì¡´ì¬í•©ë‹ˆë‹¤.';

  // ë„í˜• í¬ê¸° í‰ê·  â†’ ì—ë„ˆì§€ ìˆ˜ì¤€
  const avgSize = placed.reduce((s,p)=>s+p.size,0)/placed.length;
  let energyDesc = '';
  if (avgSize > 100) energyDesc = 'ë„í˜•ì´ í¬ê²Œ í‘œí˜„ë˜ì–´ ìˆìœ¼ë©°, ì´ëŠ” ë†’ì€ ì‹¬ë¦¬ ì—ë„ˆì§€ì™€ ì ê·¹ì ì¸ ìƒí™œ íƒœë„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.';
  else if (avgSize < 50) energyDesc = 'ë„í˜•ì˜ í¬ê¸°ê°€ ì‘ì•„ ë‚´ë©´ì˜ ìœ„ì¶•ì´ë‚˜ í”¼ë¡œê°ì´ ë°˜ì˜ë˜ì–´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
  else energyDesc = 'ì ì ˆí•œ í¬ê¸°ì˜ ë„í˜•ìœ¼ë¡œ ì—ë„ˆì§€ ìˆ˜ì¤€ì´ ì•ˆì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';

  // 3ï¸âƒ£ ê° ë„í˜• ê¸°ë³¸ ì„±í–¥
  const profile = {
    circle:{
      title:'ë™ê·¸ë¼ë¯¸ (ê°ì„±Â·ê´€ê³„í˜•)',
      traits:[
        'ê°ì •ì´ ì„¬ì„¸í•˜ê³  íƒ€ì¸ì˜ ê¸°ë¶„ ë³€í™”ì— ë¯¼ê°í•©ë‹ˆë‹¤.',
        'ì¡°í™”ì™€ ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ë©° ê°ˆë“±ì„ í”¼í•˜ë ¤ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.',
        'ìƒëŒ€ë°©ì„ í¸ì•ˆí•˜ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ì˜¨í™”í•œ ê¸°ì§ˆì„ ì§€ë‹™ë‹ˆë‹¤.'
      ],
      scent:'í”Œë¡œëŸ´Â·íŒŒìš°ë”ë¦¬ ê³„ì—´ (ë¼ë²¤ë”, ì¬ìŠ¤ë¯¼)'
    },
    triangle:{
      title:'ì„¸ëª¨ (ëª©í‘œÂ·ë¦¬ë”í˜•)',
      traits:[
        'ëª…í™•í•œ ëª©í‘œì™€ ë°©í–¥ì„±ì„ ê°€ì§€ê³  ì¶”ì§„í•©ë‹ˆë‹¤.',
        'íŒë‹¨ë ¥ê³¼ ê²°ë‹¨ë ¥ì´ ë›°ì–´ë‚˜ë©°, ë¦¬ë” ì—­í• ì„ ë§¡ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.',
        'ê²½ìŸì  ìƒí™©ì—ì„œ ì„±ì·¨ìš•ì´ ê°•í•˜ê²Œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.'
      ],
      scent:'ì‹œíŠ¸ëŸ¬ìŠ¤Â·ìŠ¤íŒŒì´ì‹œ ê³„ì—´ (ì˜¤ë Œì§€, ê·¸ë ˆì´í”„í”„ë£»)'
    },
    square:{
      title:'ë„¤ëª¨ (ì•ˆì •Â·ì²´ê³„í˜•)',
      traits:[
        'í˜„ì‹¤ì ì´ê³  ê³„íšì ì¸ ì‚¬ê³ ë¥¼ ì§€í–¥í•©ë‹ˆë‹¤.',
        'ì±…ì„ê°ì´ ê°•í•˜ë©° ì¼ê´€ì„± ìˆëŠ” íƒœë„ë¡œ ì‹ ë¢°ë¥¼ ì–»ìŠµë‹ˆë‹¤.',
        'ë³€í™”ë³´ë‹¤ ì•ˆì •ëœ í™˜ê²½ì—ì„œ ëŠ¥ë ¥ì„ ë°œíœ˜í•©ë‹ˆë‹¤.'
      ],
      scent:'ìš°ë””Â·í—ˆë¸Œ ê³„ì—´ (ìƒŒë‹¬ìš°ë“œ, ì‹œë”)'
    },
    wave:{
      title:'S (ì°½ì˜Â·ìœ ì—°í˜•)',
      traits:[
        'ê°ìˆ˜ì„±ê³¼ ì§ê´€ì´ ë°œë‹¬í•´ ì˜ˆìˆ ì , ì°½ì˜ì  í‘œí˜„ì— ëŠ¥í•©ë‹ˆë‹¤.',
        'ìœ ì—°í•œ ì‚¬ê³ ë¡œ ìƒˆë¡œìš´ ê´€ì ì„ ì‰½ê²Œ ë°›ì•„ë“¤ì…ë‹ˆë‹¤.',
        'í†µì œë³´ë‹¤ëŠ” ììœ ë¡œì›€ì„ ì„ í˜¸í•˜ë©° ìƒìƒë ¥ì´ í’ë¶€í•©ë‹ˆë‹¤.'
      ],
      scent:'ë¨¸ìŠ¤í¬Â·ë°”ë‹ë¼ ê³„ì—´ (í”„ë£¨í‹° í†¤ í¬í•¨)'
    }
  };

  // 4ï¸âƒ£ 1ì°¨Â·2ì°¨ ê¸°ì§ˆ ì¡°í•© í•´ì„
  const comboDesc = {
    'circle-triangle':'ê°ì„±ê³¼ ëª©í‘œì˜ ê· í˜•í˜•ìœ¼ë¡œ, ì¸ê°„ê´€ê³„ ì†ì—ì„œë„ ëª…í™•í•œ ì˜ì‚¬ê²°ì • ëŠ¥ë ¥ì„ ë³´ì…ë‹ˆë‹¤.',
    'triangle-circle':'ë¦¬ë”ì‹­ì— ë”°ëœ»í•¨ì´ ë”í•´ì§„ ìœ í˜•ìœ¼ë¡œ, íŒ€ì„ ì´ëŒë©´ì„œë„ ê³µê°ì  ì¡°í™”ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
    'circle-square':'ì•ˆì •ê³¼ ê´€ê³„ ì¤‘ì‹¬ì˜ ì¡°í™”í˜•ìœ¼ë¡œ, ì‹ ì¤‘í•˜ë©´ì„œë„ ë”°ëœ»í•œ ì„±í–¥ì„ ë³´ì…ë‹ˆë‹¤.',
    'square-circle':'ì‹¤ì œì ì´ë©´ì„œë„ ê°ì •ì ìœ¼ë¡œ ì„¬ì„¸í•œ í˜„ì‹¤ì  ê³µê°í˜•ì…ë‹ˆë‹¤.',
    'triangle-square':'ì²´ê³„ì ì¸ ë¦¬ë”í˜•ìœ¼ë¡œ, ì„±ì·¨ë¥¼ ìœ„í•´ êµ¬ì¡°ë¥¼ ì„¸ìš°ëŠ” ëŠ¥ë ¥ì´ ë‹ë³´ì…ë‹ˆë‹¤.',
    'square-triangle':'ì±…ì„ê°ê³¼ ì¶”ì§„ë ¥ì´ ê²°í•©ëœ ì‹¤í–‰í˜•ìœ¼ë¡œ, ì¼ì˜ ì™„ì„±ë„ë¥¼ ì¤‘ì‹œí•©ë‹ˆë‹¤.',
    'circle-wave':'ê°ì„±ì  ìƒìƒë ¥í˜•ìœ¼ë¡œ, ì˜ˆìˆ ì  ê°ìˆ˜ì„±ê³¼ íƒ€ì¸ ì´í•´ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.',
    'wave-circle':'ê°ì •ê³¼ ì°½ì˜ê°€ ìœ ê¸°ì ìœ¼ë¡œ ìœµí•©ëœ í‘œí˜„í˜•ìœ¼ë¡œ, ì •ì„œì  ì§ê´€ì´ ë‹ë³´ì…ë‹ˆë‹¤.',
    'triangle-wave':'ëª©í‘œ ì§€í–¥ì„±ê³¼ ì°½ì˜ì„±ì´ ìœµí•©ë˜ì–´ í˜ì‹ ì„ ì¶”êµ¬í•˜ëŠ” ìœ í˜•ì…ë‹ˆë‹¤.',
    'wave-triangle':'ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ë¦¬ë”ì‹­ìœ¼ë¡œ ì‹¤í˜„í•˜ëŠ” ì°½ì¡°ì  ì£¼ë„í˜•ì…ë‹ˆë‹¤.',
    'square-wave':'êµ¬ì¡° ì†ì˜ ì°½ì˜í˜•ìœ¼ë¡œ, ë…¼ë¦¬ì ì´ë©´ì„œë„ ìœ ì—°í•˜ê²Œ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.',
    'wave-square':'ê°ê°ì ì´ì§€ë§Œ ì²´ê³„ì ì¸ ì‚¬ê³ ë¥¼ ê²¸ë¹„í•œ ì¡°í™”í˜•ì…ë‹ˆë‹¤.'
  };
  const comboKey = `${dominant}-${secondary}`;
  const comboLine = comboDesc[comboKey] || 'ì£¼ìš” ì„±í–¥ì´ í•œìª½ìœ¼ë¡œ ëšœë ·í•˜ê²Œ ë‚˜íƒ€ë‚˜ë©° ë‚´ë©´ì˜ ê· í˜•ì´ ê³¼ì œë¡œ ë³´ì…ë‹ˆë‹¤.';

  // 5ï¸âƒ£ ê²°ê³¼ ì¶œë ¥ êµ¬ì„±
  const d1 = profile[dominant];
  const d2 = profile[secondary];

  let html = `<div class="line"><strong>ì„±í–¥</strong></div>`;
  html += `<div class="line">ì£¼ ê¸°ì§ˆ: <b>${d1.title}</b></div>`;
  d1.traits.forEach(l=> html += `<div class="line">â€¢ ${l}</div>`);
  html += `<div class="line">ë³´ì¡° ê¸°ì§ˆ: <b>${d2.title}</b></div>`;
  d2.traits.forEach(l=> html += `<div class="line">â€¢ ${l}</div>`);
  html += `<div class="line">${comboLine}</div>`;
  html += `<div class="line">${balanceDesc}</div>`;
  html += `<div class="line">${energyDesc}</div>`;
  html += `<div class="line"><strong>ì¶”ì²œ í–¥</strong></div>`;
  html += `<div class="scent">â€¢ ${d1.scent}</div>`;

  resultContent.innerHTML = html;
};

document.getElementById('saveImage').addEventListener('click', ()=>{
  const result = document.getElementById('resultBox');
  html2canvas(result, {scale:2, backgroundColor:'#fbf6f4'}).then(canvas=>{
    const link = document.createElement('a');
    link.download = 'ë„í˜•ì‹¬ë¦¬í…ŒìŠ¤íŠ¸_ê²°ê³¼.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  });
});

document.getElementById('saveImage').addEventListener('click', ()=>{
  const result = document.getElementById('resultBox');
  html2canvas(result, {scale:2, backgroundColor:'#fbf6f4'}).then(canvas=>{
    const dataUrl = canvas.toDataURL('image/png');
    if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
      // iOSì—ì„œëŠ” ìƒˆ íƒ­ìœ¼ë¡œ ì´ë¯¸ì§€ ì—´ê¸°
      const imageWindow = window.open('', '_blank');
      imageWindow.document.write('<img src="'+dataUrl+'" style="width:100%">');
    } else {
      // ì•ˆë“œë¡œì´ë“œ, PCëŠ” ìë™ ë‹¤ìš´ë¡œë“œ
      const link = document.createElement('a');
      link.download = 'ë„í˜•ì‹¬ë¦¬í…ŒìŠ¤íŠ¸_ê²°ê³¼.png';
      link.href = dataUrl;
      link.click();
    }
  });
});

</script>
</body>
</html>
