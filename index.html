<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>도형심리테스트</title>
<style>
  body {
    font-family: 'Noto Sans KR', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    background-color: #fafafa;
    margin: 0;
    padding: 20px;
  }
  h1 { margin-bottom: 5px; }
  p { font-size: 14px; color: #444; margin-top: 0; margin-bottom: 20px; }
  #canvas-container {
    position: relative;
    width: 400px; height: 400px;
    background-color: white;
    border: 2px solid #aaa;
    display: flex; align-items: center; justify-content: center;
  }
  #inner-square {
    position: absolute;
    width: 200px; height: 200px;
    border: 1.5px dashed #ccc;
  }
  .shape {
    margin: 5px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  .shape:hover { transform: scale(1.2); }
  #controls { margin-top: 15px; }
  #result {
    margin-top: 25px;
    padding: 15px;
    width: 80%;
    background-color: #f8f8f8;
    border-radius: 8px;
    text-align: left;
    line-height: 1.6;
  }
</style>
</head>
<body>

<h1>○ △ □ S 도형심리테스트</h1>
<p>1) 마음에 드는 도형 1개를 3번, 나머지 도형은 각각 1번씩 자유롭게 그려주세요.<br>
최대 6개까지 선택 가능합니다.</p>

<div id="canvas-container">
  <div id="inner-square"></div>
  <canvas id="drawingCanvas" width="400" height="400"></canvas>
</div>

<div id="controls">
  <button class="shape" data-shape="circle">⚪</button>
  <button class="shape" data-shape="triangle">▲</button>
  <button class="shape" data-shape="square">■</button>
  <button class="shape" data-shape="wave">S</button>
  <button id="undoBtn">↩ 되돌리기</button>
  <button id="resultBtn">결과 보기</button>
</div>

<div id="result"></div>

<script>
const canvas = document.getElementById('drawingCanvas');
const ctx = canvas.getContext('2d');
let shapes = [];
const maxShapes = 6;

function drawShape(x, y, type, size=50) {
  ctx.beginPath();
  if (type === 'circle') {
    ctx.arc(x, y, size/2, 0, Math.PI * 2);
  } else if (type === 'triangle') {
    ctx.moveTo(x, y - size/2);
    ctx.lineTo(x - size/2, y + size/2);
    ctx.lineTo(x + size/2, y + size/2);
    ctx.closePath();
  } else if (type === 'square') {
    ctx.rect(x - size/2, y - size/2, size, size);
  } else if (type === 'wave') {
    ctx.font = `${size}px serif`;
    ctx.fillText('S', x - size/3, y + size/3);
  }
  ctx.stroke();
}

document.querySelectorAll('.shape').forEach(btn => {
  btn.addEventListener('click', () => {
    if (shapes.length >= maxShapes) {
      alert('최대 6개까지만 선택할 수 있습니다.');
      return;
    }
    const type = btn.dataset.shape;
    const x = Math.random() * 300 + 50;
    const y = Math.random() * 300 + 50;
    shapes.push({ type, x, y });
    drawShape(x, y, type);
  });
});

document.getElementById('undoBtn').addEventListener('click', () => {
  if (shapes.length > 0) {
    shapes.pop();
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    shapes.forEach(s => drawShape(s.x, s.y, s.type));
  }
});

document.getElementById('resultBtn').addEventListener('click', () => {
  const resultDiv = document.getElementById('result');
  if (shapes.length < 4) {
    resultDiv.innerHTML = '도형을 모두 배치한 후 결과를 확인하세요.';
    return;
  }

  const counts = shapes.reduce((acc, s) => {
    acc[s.type] = (acc[s.type] || 0) + 1;
    return acc;
  }, {});

  let dominant = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
  let text = '';

  // 도형심리프로파일 기반 해석
  const interpretations = {
    circle: {
      type: '감성적 공감형',
      trait: `당신은 감정의 흐름을 섬세하게 감지하고, 인간관계 속에서 따뜻함과 배려를 중요하게 여깁니다.
      타인의 감정에 공감하며 주변을 편안하게 만드는 힘이 있습니다. 그러나 때로는 감정에 치우쳐 스스로를 희생할 때도 있습니다.
      감정의 조절과 자기 표현의 균형이 조화를 이룰 때 안정감을 얻습니다.`,
      scent: '추천 향: 라벤더나 재스민 같은 플로럴 계열의 향이 어울립니다.'
    },
    triangle: {
      type: '목표 중심 리더형',
      trait: `당신은 방향감이 뚜렷하고, 목표를 세우면 끝까지 밀고 나가는 추진력을 지녔습니다.
      리더십이 강하고 결단력 있는 태도로 주변을 이끌지만, 완벽을 추구하다 부담을 느끼기도 합니다.
      균형 잡힌 휴식과 타인의 의견 수용이 성장을 돕습니다.`,
      scent: '추천 향: 시트러스 계열의 상큼한 향이 에너지를 북돋워 줍니다.'
    },
    square: {
      type: '안정적 현실형',
      trait: `당신은 체계적이고 성실하며 신뢰받는 사람입니다. 일의 순서와 규칙을 중요하게 생각하며,
      자신이 맡은 일에 책임감을 가지고 꾸준히 완성합니다. 다만 변화에 대한 두려움이 있을 수 있습니다.
      새로운 시도에 작은 용기를 낼 때 더 넓은 가능성이 열립니다.`,
      scent: '추천 향: 우디나 머스크 계열의 안정적인 향이 마음을 편안하게 합니다.'
    },
    wave: {
      type: '창의적 자유형',
      trait: `당신은 상상력과 감수성이 풍부하며, 기존의 틀을 넘어 새로운 방식으로 세상을 바라봅니다.
      변화에 빠르게 적응하고 예술적 감각이 돋보이지만, 현실적인 실행력에서는 갈등을 겪을 수 있습니다.
      아이디어를 구체화할 때 당신의 능력이 더욱 빛납니다.`,
      scent: '추천 향: 프루티나 허브 계열의 신선한 향이 창의성을 자극합니다.'
    }
  };

  const main = interpretations[dominant];
  text += `<strong>성향:</strong><br>${main.trait}<br><br><strong>${main.scent}</strong>`;

  resultDiv.innerHTML = text;
});
</script>

</body>
</html>